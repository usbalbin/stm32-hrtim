[package]
name = "stm32-hrtim"
version = "0.1.0"
edition = "2021"

[dependencies]

stm32f3 = { git = "https://github.com/stm32-rs/stm32-rs-nightlies", optional = true }
stm32h7 = { git = "https://github.com/stm32-rs/stm32-rs-nightlies", fatures = ["critical-section"], optional = true }
#stm32g4 = { git = "", optional = true }

#stm32f3xx-hal = { version = "0.10.0", optional = true }
stm32f3xx-hal = { git = "https://github.com/usbalbin/stm32f3xx-hal", branch = "update_for_new_pac", optional = true }
#stm32h7xx-hal = { version = "0.16.0", optional = true }
stm32h7xx-hal = { git = "https://github.com/usbalbin/stm32h7xx-hal", branch = "update_for_new_pac", optional = true }
#stm32h7xx-hal = { path = "../stm32h7xx-hal", optional = true }

#stm32g4xx-hal = { version = "0.0.1", optional = true }
stm32g4xx-hal = { git = "https://github.com/stm32-rs/stm32g4xx-hal", branch = "staged-pac", optional = true }
#stm32g4xx-hal = { path = "../stm32g4xx-hal", optional = true }
defmt = { version = "0.3.10", optional = true }
fugit = "0.3.7"

[dev-dependencies]
cortex-m = { version = "0.7.7", features = ["critical-section-single-core"] }
defmt-rtt = "0.4.0"
cortex-m-rt = "0.7.2"
panic-probe = { version = "0.3.0", features = ["print-defmt"] }

[features]
default = []

hrtim_v1 = []
hrtim_v1_1 = []
hrtim_v2 = []

stm32f3 = ["stm32f3/stm32f3x4"]
stm32h7 = ["dep:stm32h7"]
stm32g4 = []

stm32f334x4 = ["stm32f3", "stm32f3xx-hal/stm32f334x4", "hrtim_v1"]
stm32f334x6 = ["stm32f3", "stm32f3xx-hal/stm32f334x6", "hrtim_v1"]
stm32f334x8 = ["stm32f3", "stm32f3xx-hal/stm32f334x8", "hrtim_v1"]

stm32h742 = ["stm32h7", "stm32h7xx-hal/stm32h742", "hrtim_v1_1"]
stm32h743 = ["stm32h7", "stm32h7xx-hal/stm32h743", "hrtim_v1_1"]
#stm32h745 = ["stm32h7", "stm32h7xx-hal/stm32h745", "hrtim_v1_1"]
stm32h747cm7 = ["stm32h7", "stm32h7xx-hal/stm32h747cm7", "hrtim_v1_1"]
stm32h750 = ["stm32h7", "stm32h7xx-hal/stm32h750", "hrtim_v1_1"]
stm32h753 = ["stm32h7", "stm32h7xx-hal/stm32h753", "hrtim_v1_1"]
#stm32h755 = ["stm32h7", "stm32h7xx-hal/stm32h755", "hrtim_v1_1"]
#stm32h757 = ["stm32h7", "stm32h7xx-hal/stm32h757", "hrtim_v1_1"]

stm32g474 = ["stm32g4", "stm32g4xx-hal/stm32g474", "hrtim_v2"]
stm32g484 = ["stm32g4", "stm32g4xx-hal/stm32g484", "hrtim_v2"]
defmt = ["dep:defmt", "fugit/defmt"]

# F3

[[example]]
name = "stm32f3"
required-features = ["stm32f3"]
path = "examples/stm32f3/hrtim.rs"


# G4

[[example]]
name = "stm32g4-adc-trigger"
required-features = ["stm32g4"]
path = "examples/stm32g4/adc-trigger.rs"

[[example]]
name = "stm32g4-capture"
required-features = ["stm32g4"]
path = "examples/stm32g4/capture.rs"

[[example]]
name = "stm32g4-capture-dma"
required-features = ["stm32g4"]
path = "examples/stm32g4/capture-dma.rs"

[[example]]
name = "stm32g4-eev-comp"
required-features = ["stm32g4"]
path = "examples/stm32g4/eev-comp.rs"

[[example]]
name = "stm32g4-eev"
required-features = ["stm32g4"]
path = "examples/stm32g4/eev.rs"

[[example]]
name = "stm32g4-flt-comp"
required-features = ["stm32g4"]
path = "examples/stm32g4/flt-comp.rs"

[[example]]
name = "stm32g4-flt"
required-features = ["stm32g4"]
path = "examples/stm32g4/flt.rs"

[[example]]
name = "stm32g4"
required-features = ["stm32g4"]
path = "examples/stm32g4/hrtim.rs"

[[example]]
name = "stm32g4-master"
required-features = ["stm32g4"]
path = "examples/stm32g4/master.rs"

# H7

[[example]]
name = "stm32h7"
required-features = ["stm32h7"]
path = "examples/stm32h7/hrtim.rs"